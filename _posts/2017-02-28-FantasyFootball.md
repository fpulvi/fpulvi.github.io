---
layout: post
title:  "FantasyFootball feature engineering"
date:   2017-02-28 13:51:05 +0100
categories: use-case
---

In this project, we will try to predict the performances of the players of Italian football championship Serie A.
The project is meant in the context of Fantasy Football, a popular player in which a group of friends organize a virtual
team of real seria A players. The aim of the game is reach the highest score, given the score the sum of the performance evaluation marks
of the players of your team. 
Predicting the mark of your players could definitely be an advantage for a fantasy football coach.

In this first notebook, we will create the dataset and do a lot of feature engineering.


```python
#import
from sqlalchemy import create_engine
import pandas as pd
import numpy as np

```

Let try to extract data from the sqlite dataset


```python
engine = create_engine('sqlite:///2014')
# Open engine connection: con
con = engine.connect()
table_names = engine.table_names()
print(table_names)
```

    [u'games', u'marks_corriere', u'marks_fantagazzetta', u'marks_gazzetta', u'players', u'sqlite_sequence']
    

let's focus for the moment on the results of just one sport newspaper such as Gazzetta


```python
with engine.connect() as con:
    rs = con.execute('SELECT * from games')
    # Save results of the query to DataFrame: df
    games = pd.DataFrame(rs.fetchall())
    games.columns = rs.keys()
    
    rs = con.execute('SELECT * from marks_gazzetta')
    marks = pd.DataFrame(rs.fetchall())
    marks.columns = rs.keys()
    
    rs = con.execute('SELECT * from players')
    players = pd.DataFrame(rs.fetchall())
    players.columns = rs.keys()
```


```python
players.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>team</th>
      <th>role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2248</td>
      <td>Benalouane</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2249</td>
      <td>Biava</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2250</td>
      <td>Drame'</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2251</td>
      <td>Zappacosta</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div>




```python
marks.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>day</th>
      <th>player</th>
      <th>team</th>
      <th>mark</th>
      <th>goal</th>
      <th>gotgoal</th>
      <th>penalty</th>
      <th>spenalty</th>
      <th>mpenalty</th>
      <th>owngoal</th>
      <th>assist</th>
      <th>ycard</th>
      <th>rcard</th>
      <th>fmark</th>
      <th>enter</th>
      <th>exit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>21175</td>
      <td>1</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21176</td>
      <td>1</td>
      <td>2248</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21177</td>
      <td>1</td>
      <td>2249</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>21178</td>
      <td>1</td>
      <td>2250</td>
      <td>Atalanta</td>
      <td>5.5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21179</td>
      <td>1</td>
      <td>2251</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



Let's join this dataset in order to obtain the player names together with the id (it won't affect the results of course, but it will be easier to check the process


```python
marks_merged = pd.merge(marks,players, how = 'inner', left_on='player', right_on='id')
marks_merged.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_x</th>
      <th>day</th>
      <th>player</th>
      <th>team_x</th>
      <th>mark</th>
      <th>goal</th>
      <th>gotgoal</th>
      <th>penalty</th>
      <th>spenalty</th>
      <th>mpenalty</th>
      <th>...</th>
      <th>assist</th>
      <th>ycard</th>
      <th>rcard</th>
      <th>fmark</th>
      <th>enter</th>
      <th>exit</th>
      <th>id_y</th>
      <th>name</th>
      <th>team_y</th>
      <th>role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>21175</td>
      <td>1</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21453</td>
      <td>2</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>7.5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>0</td>
      <td>0</td>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21733</td>
      <td>3</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22012</td>
      <td>4</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>6.5</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>0</td>
      <td>0</td>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22291</td>
      <td>5</td>
      <td>2247</td>
      <td>Atalanta</td>
      <td>5.0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>P</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 21 columns</p>
</div>




```python
marks_merged.sort_values(['day', 'team_x','name']).head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_x</th>
      <th>day</th>
      <th>player</th>
      <th>team_x</th>
      <th>mark</th>
      <th>goal</th>
      <th>gotgoal</th>
      <th>penalty</th>
      <th>spenalty</th>
      <th>mpenalty</th>
      <th>...</th>
      <th>assist</th>
      <th>ycard</th>
      <th>rcard</th>
      <th>fmark</th>
      <th>enter</th>
      <th>exit</th>
      <th>id_y</th>
      <th>name</th>
      <th>team_y</th>
      <th>role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37</th>
      <td>21176</td>
      <td>1</td>
      <td>2248</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>2248</td>
      <td>Benalouane</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>281</th>
      <td>21186</td>
      <td>1</td>
      <td>2258</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>1</td>
      <td>0</td>
      <td>2258</td>
      <td>Bianchi</td>
      <td>Atalanta</td>
      <td>A</td>
    </tr>
    <tr>
      <th>64</th>
      <td>21177</td>
      <td>1</td>
      <td>2249</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>2249</td>
      <td>Biava</td>
      <td>Atalanta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>302</th>
      <td>21187</td>
      <td>1</td>
      <td>2259</td>
      <td>Atalanta</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4.5</td>
      <td>1</td>
      <td>0</td>
      <td>2259</td>
      <td>Boakye</td>
      <td>Atalanta</td>
      <td>A</td>
    </tr>
    <tr>
      <th>140</th>
      <td>21180</td>
      <td>1</td>
      <td>2252</td>
      <td>Atalanta</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>2252</td>
      <td>Bonaventura</td>
      <td>Milan</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 21 columns</p>
</div>



For the moment let's use just a subset of the features, we will have time to get them back.


```python
marks_final = marks_merged[['player','name','team_x','day','goal','penalty','owngoal','mark']]
```

Don't really like that "team_x"


```python
marks_final=marks_final.rename(columns = {'team_x':'team'})
```

let us focus on the games.


```python
games.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day</th>
      <th>home</th>
      <th>away</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Chievo</td>
      <td>Juventus</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Atalanta</td>
      <td>Verona</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Torino</td>
      <td>Inter</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Sassuolo</td>
      <td>Cagliari</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Genoa</td>
      <td>Napoli</td>
    </tr>
  </tbody>
</table>
</div>



as suspected, there are no results for the matches. We should obtain those from the player statistics. What will influence the results?
- Of course, the Goals, so consider the feature gol of the dataset marks
- What about the penalties? Let's consider them as well
- Do not forget the unfortunate owngoals


```python
def whoWon (teamH,teamA,day):
    """simple functions aimed to deliver the winner of each game"""
    marksSpecificH = marks_final[(marks_final['day'] == day) & (marks_final['team'] == teamH)]
    marksSpecificA = marks_final[(marks_final['day'] == day) & (marks_final['team'] == teamA)]
    
    #print(marksSpecificH)
    goalH = marksSpecificH['goal'].sum() + marksSpecificH['penalty'].sum() + marksSpecificA['owngoal'].sum()

    
    #print(marksSpecificA)
    goalA = marksSpecificA['goal'].sum() + marksSpecificA['penalty'].sum() + marksSpecificH['owngoal'].sum()
    
    winner = 0
    if (goalH > goalA): winner = 1
    if (goalH < goalA): winner = 2
    if (goalH == goalA): winner = 0
    return winner
```


```python
games['winner'] = map(lambda teamH,teamA,day: whoWon(teamH,teamA,day), games['home'], games['away'], games['day'])
games[games['day']==1]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day</th>
      <th>home</th>
      <th>away</th>
      <th>winner</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Chievo</td>
      <td>Juventus</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Atalanta</td>
      <td>Verona</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Torino</td>
      <td>Inter</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Sassuolo</td>
      <td>Cagliari</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Genoa</td>
      <td>Napoli</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>Palermo</td>
      <td>Sampdoria</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>Cesena</td>
      <td>Parma</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>Roma</td>
      <td>Fiorentina</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>Udinese</td>
      <td>Empoli</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>Milan</td>
      <td>Lazio</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



Very good! now we have the results. However, I am afraid that we need more feature engineering if we want other interesting informations.
Indeed, the rank of the team is quite an important matter, for this we need to rebuild the rankings.


```python
days = np.arange(0,39,1)
teams = games1['home']
teams = teams.drop_duplicates()
```


```python
points = pd.DataFrame(columns=np.arange(0,39,1))
points['Team'] = teams
points[0] = 0
```


```python
cols = points.columns.tolist()
cols = cols[-1:] + cols[:-1]
points = points[cols]
```


```python
points
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>...</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chievo</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atalanta</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Torino</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sassuolo</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Genoa</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Palermo</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Cesena</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Roma</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Udinese</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Milan</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Napoli</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Empoli</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Fiorentina</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Cagliari</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Juventus</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Verona</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sampdoria</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Lazio</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Parma</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Inter</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>20 rows Ã— 40 columns</p>
</div>




```python
def updatePoints (teamH,teamA,day,winner):
    if (winner == 1):
        points.ix[points['Team'] == teamH, day] = 3
        points.ix[points['Team'] == teamA, day] = 0
    if (winner == 2):
        points.ix[points['Team'] == teamA, day] = 3
        points.ix[points['Team'] == teamH, day] = 0
    if (winner == 0):
        points.ix[points['Team'] == teamH, day] = 1
        points.ix[points['Team'] == teamA, day] = 1
```


```python
_ = map(lambda teamH,teamA,day,winner: updatePoints(teamH,teamA,day,winner), games['home'], games['away'], games['day'], games['winner'])
```


```python
points
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>...</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chievo</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atalanta</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Torino</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sassuolo</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Genoa</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Palermo</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Cesena</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Roma</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Udinese</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Milan</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Napoli</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Empoli</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Fiorentina</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Cagliari</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Juventus</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Verona</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sampdoria</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Lazio</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Parma</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Inter</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>20 rows Ã— 40 columns</p>
</div>




```python
#print(pointsTest)
points['total'] = 0
for i in range(39):
    points['total'] = points['total'] + points[i]    
points
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>...</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chievo</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atalanta</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>37</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Torino</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>54</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sassuolo</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>49</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Genoa</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>59</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Palermo</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>49</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Cesena</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Roma</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>70</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Udinese</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>41</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Milan</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Napoli</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>63</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Empoli</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>42</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Fiorentina</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>64</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Cagliari</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>34</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Juventus</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>87</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Verona</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>46</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sampdoria</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>56</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Lazio</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>69</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Parma</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>26</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Inter</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>55</td>
    </tr>
  </tbody>
</table>
<p>20 rows Ã— 41 columns</p>
</div>



Cool, now let's try to obtain the position in the rank for each day of the championship


```python
pointsDay = pd.DataFrame(columns=np.arange(0,39,1))
pointsDay['Team'] = teams
pointsDay[0] = 0

for i in range(1,39):
    pointsDay[i] = pointsDay[i-1] + points[i]
pointsDay
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>Team</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>35</td>
      <td>36</td>
      <td>37</td>
      <td>40</td>
      <td>41</td>
      <td>42</td>
      <td>42</td>
      <td>43</td>
      <td>43</td>
      <td>Chievo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>7</td>
      <td>8</td>
      <td>...</td>
      <td>29</td>
      <td>30</td>
      <td>31</td>
      <td>32</td>
      <td>33</td>
      <td>36</td>
      <td>36</td>
      <td>37</td>
      <td>37</td>
      <td>Atalanta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>8</td>
      <td>8</td>
      <td>11</td>
      <td>...</td>
      <td>43</td>
      <td>44</td>
      <td>47</td>
      <td>48</td>
      <td>48</td>
      <td>48</td>
      <td>51</td>
      <td>51</td>
      <td>54</td>
      <td>Torino</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
      <td>...</td>
      <td>35</td>
      <td>36</td>
      <td>36</td>
      <td>36</td>
      <td>37</td>
      <td>40</td>
      <td>43</td>
      <td>46</td>
      <td>49</td>
      <td>Sassuolo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>8</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
      <td>...</td>
      <td>44</td>
      <td>44</td>
      <td>47</td>
      <td>50</td>
      <td>50</td>
      <td>53</td>
      <td>56</td>
      <td>59</td>
      <td>59</td>
      <td>Genoa</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>9</td>
      <td>...</td>
      <td>38</td>
      <td>41</td>
      <td>41</td>
      <td>42</td>
      <td>43</td>
      <td>43</td>
      <td>46</td>
      <td>46</td>
      <td>49</td>
      <td>Palermo</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>...</td>
      <td>22</td>
      <td>23</td>
      <td>23</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>Cesena</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
      <td>15</td>
      <td>18</td>
      <td>19</td>
      <td>22</td>
      <td>...</td>
      <td>57</td>
      <td>58</td>
      <td>58</td>
      <td>61</td>
      <td>64</td>
      <td>64</td>
      <td>67</td>
      <td>70</td>
      <td>70</td>
      <td>Roma</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
      <td>13</td>
      <td>13</td>
      <td>16</td>
      <td>16</td>
      <td>...</td>
      <td>34</td>
      <td>35</td>
      <td>38</td>
      <td>38</td>
      <td>41</td>
      <td>41</td>
      <td>41</td>
      <td>41</td>
      <td>41</td>
      <td>Udinese</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>11</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>...</td>
      <td>42</td>
      <td>43</td>
      <td>43</td>
      <td>43</td>
      <td>43</td>
      <td>46</td>
      <td>46</td>
      <td>49</td>
      <td>52</td>
      <td>Milan</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
      <td>11</td>
      <td>14</td>
      <td>15</td>
      <td>...</td>
      <td>50</td>
      <td>53</td>
      <td>56</td>
      <td>56</td>
      <td>59</td>
      <td>60</td>
      <td>63</td>
      <td>63</td>
      <td>63</td>
      <td>Napoli</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>...</td>
      <td>33</td>
      <td>34</td>
      <td>35</td>
      <td>38</td>
      <td>41</td>
      <td>41</td>
      <td>41</td>
      <td>42</td>
      <td>42</td>
      <td>Empoli</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>10</td>
      <td>13</td>
      <td>...</td>
      <td>49</td>
      <td>49</td>
      <td>49</td>
      <td>49</td>
      <td>52</td>
      <td>55</td>
      <td>58</td>
      <td>61</td>
      <td>64</td>
      <td>Fiorentina</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>9</td>
      <td>...</td>
      <td>21</td>
      <td>21</td>
      <td>24</td>
      <td>24</td>
      <td>27</td>
      <td>28</td>
      <td>28</td>
      <td>31</td>
      <td>34</td>
      <td>Cagliari</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
      <td>18</td>
      <td>19</td>
      <td>22</td>
      <td>22</td>
      <td>...</td>
      <td>70</td>
      <td>73</td>
      <td>73</td>
      <td>76</td>
      <td>79</td>
      <td>80</td>
      <td>83</td>
      <td>86</td>
      <td>87</td>
      <td>Juventus</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
      <td>8</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>12</td>
      <td>...</td>
      <td>33</td>
      <td>36</td>
      <td>39</td>
      <td>40</td>
      <td>40</td>
      <td>41</td>
      <td>44</td>
      <td>45</td>
      <td>46</td>
      <td>Verona</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>11</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>...</td>
      <td>49</td>
      <td>50</td>
      <td>50</td>
      <td>51</td>
      <td>51</td>
      <td>54</td>
      <td>54</td>
      <td>55</td>
      <td>56</td>
      <td>Sampdoria</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
      <td>16</td>
      <td>...</td>
      <td>58</td>
      <td>58</td>
      <td>59</td>
      <td>62</td>
      <td>63</td>
      <td>63</td>
      <td>66</td>
      <td>66</td>
      <td>69</td>
      <td>Lazio</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>19</td>
      <td>20</td>
      <td>23</td>
      <td>23</td>
      <td>23</td>
      <td>24</td>
      <td>24</td>
      <td>25</td>
      <td>26</td>
      <td>Parma</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
      <td>...</td>
      <td>41</td>
      <td>42</td>
      <td>45</td>
      <td>48</td>
      <td>49</td>
      <td>52</td>
      <td>52</td>
      <td>52</td>
      <td>55</td>
      <td>Inter</td>
    </tr>
  </tbody>
</table>
<p>20 rows Ã— 40 columns</p>
</div>




```python
rankDay = pd.DataFrame(columns=np.arange(0,39,1))
rankDay['Team'] = teams
```


```python
for i in range(0,39): 
    rankDay[i] = pointsDay[i].rank(ascending=0)
    rankDay[i] = map(lambda x: int(x), rankDay[i])
rankDay.sort_values(by=38) 

```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>Team</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>10</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>Juventus</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>Roma</td>
    </tr>
    <tr>
      <th>17</th>
      <td>10</td>
      <td>17</td>
      <td>10</td>
      <td>13</td>
      <td>16</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>Lazio</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10</td>
      <td>17</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>9</td>
      <td>8</td>
      <td>10</td>
      <td>11</td>
      <td>10</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>Fiorentina</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
      <td>11</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>8</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>Napoli</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>17</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>12</td>
      <td>10</td>
      <td>10</td>
      <td>8</td>
      <td>8</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>Genoa</td>
    </tr>
    <tr>
      <th>16</th>
      <td>10</td>
      <td>10</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>Sampdoria</td>
    </tr>
    <tr>
      <th>19</th>
      <td>10</td>
      <td>10</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>10</td>
      <td>10</td>
      <td>8</td>
      <td>8</td>
      <td>...</td>
      <td>10</td>
      <td>10</td>
      <td>9</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>Inter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>10</td>
      <td>15</td>
      <td>19</td>
      <td>11</td>
      <td>12</td>
      <td>14</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>...</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>9</td>
      <td>9</td>
      <td>9</td>
      <td>9</td>
      <td>Torino</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>9</td>
      <td>9</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>Milan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10</td>
      <td>10</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>18</td>
      <td>19</td>
      <td>15</td>
      <td>17</td>
      <td>14</td>
      <td>...</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>10</td>
      <td>11</td>
      <td>10</td>
      <td>11</td>
      <td>11</td>
      <td>Palermo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>10</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>18</td>
      <td>19</td>
      <td>18</td>
      <td>15</td>
      <td>13</td>
      <td>...</td>
      <td>12</td>
      <td>13</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>16</td>
      <td>13</td>
      <td>11</td>
      <td>11</td>
      <td>Sassuolo</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10</td>
      <td>10</td>
      <td>5</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>7</td>
      <td>10</td>
      <td>11</td>
      <td>...</td>
      <td>15</td>
      <td>13</td>
      <td>12</td>
      <td>12</td>
      <td>15</td>
      <td>14</td>
      <td>12</td>
      <td>13</td>
      <td>13</td>
      <td>Verona</td>
    </tr>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>17</td>
      <td>10</td>
      <td>13</td>
      <td>16</td>
      <td>15</td>
      <td>16</td>
      <td>18</td>
      <td>19</td>
      <td>19</td>
      <td>...</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>12</td>
      <td>13</td>
      <td>12</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>Chievo</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10</td>
      <td>17</td>
      <td>19</td>
      <td>19</td>
      <td>19</td>
      <td>18</td>
      <td>12</td>
      <td>13</td>
      <td>15</td>
      <td>17</td>
      <td>...</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>14</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>15</td>
      <td>15</td>
      <td>Empoli</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>3</td>
      <td>10</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>...</td>
      <td>14</td>
      <td>15</td>
      <td>13</td>
      <td>14</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>16</td>
      <td>Udinese</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>10</td>
      <td>5</td>
      <td>9</td>
      <td>11</td>
      <td>15</td>
      <td>16</td>
      <td>13</td>
      <td>15</td>
      <td>16</td>
      <td>...</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>Atalanta</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10</td>
      <td>10</td>
      <td>15</td>
      <td>19</td>
      <td>20</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>12</td>
      <td>14</td>
      <td>...</td>
      <td>19</td>
      <td>19</td>
      <td>18</td>
      <td>18</td>
      <td>18</td>
      <td>18</td>
      <td>18</td>
      <td>18</td>
      <td>18</td>
      <td>Cagliari</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10</td>
      <td>17</td>
      <td>19</td>
      <td>13</td>
      <td>16</td>
      <td>18</td>
      <td>19</td>
      <td>20</td>
      <td>20</td>
      <td>20</td>
      <td>...</td>
      <td>20</td>
      <td>20</td>
      <td>19</td>
      <td>20</td>
      <td>20</td>
      <td>19</td>
      <td>19</td>
      <td>19</td>
      <td>19</td>
      <td>Parma</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>3</td>
      <td>10</td>
      <td>9</td>
      <td>11</td>
      <td>12</td>
      <td>12</td>
      <td>15</td>
      <td>17</td>
      <td>18</td>
      <td>...</td>
      <td>18</td>
      <td>18</td>
      <td>19</td>
      <td>18</td>
      <td>19</td>
      <td>19</td>
      <td>19</td>
      <td>20</td>
      <td>20</td>
      <td>Cesena</td>
    </tr>
  </tbody>
</table>
<p>20 rows Ã— 40 columns</p>
</div>



This is the rank day by day. The Juventus Team has been on the top from the very first days. Let's add this information (the rank of the ownteam and the rank of the opponent) to the marks dataset.


```python
def rankOwnTeam (OwnTeam, day):
    rankOwnTeam = rankDay.ix[rankDay['Team'] == OwnTeam, day-1]
    return int(rankOwnTeam)

marks_final['rankOwnTeam'] = map(lambda ownTeam, day: rankOwnTeam(ownTeam, day), marks_final['team'], marks_final['day'])
```


```python
marks_final.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player</th>
      <th>name</th>
      <th>team</th>
      <th>day</th>
      <th>goal</th>
      <th>penalty</th>
      <th>owngoal</th>
      <th>mark</th>
      <th>rankOwnTeam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>



Ok, done for the own team, let's try to add the opponent, less easy because it is dependent on the calendar.


```python
def playingHome (OwnTeam, day):
    temp = games.ix[(games['day'] == day)] 
    return (len(temp[temp['home'] == OwnTeam]))
```


```python
marks_final['playingHome'] = map(lambda ownTeam, day: playingHome(ownTeam, day), marks_final['team'], marks_final['day'])
marks_final.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player</th>
      <th>name</th>
      <th>team</th>
      <th>day</th>
      <th>goal</th>
      <th>penalty</th>
      <th>owngoal</th>
      <th>mark</th>
      <th>rankOwnTeam</th>
      <th>playingHome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>11</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



We have added the info if it the player is playing home. it could be usefull!


```python
def opponentTeam (OwnTeam, day):
    temp = games.ix[(games['day'] == day)] 
    if (len(temp[temp['home'] == OwnTeam])):
        opponent = games.ix[(games['day'] == day) & (games['home'] == OwnTeam), 'away'] 
    else:
        opponent = games.ix[(games['day'] == day) & (games['away'] == OwnTeam), 'home'] 
    return str(opponent.values[0])



marks_final['opponentTeam'] = map(lambda ownTeam, day: opponentTeam(ownTeam, day), marks_final['team'], marks_final['day'])
```


```python
marks_final.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player</th>
      <th>name</th>
      <th>team</th>
      <th>day</th>
      <th>goal</th>
      <th>penalty</th>
      <th>owngoal</th>
      <th>mark</th>
      <th>rankOwnTeam</th>
      <th>playingHome</th>
      <th>opponentTeam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>10</td>
      <td>1</td>
      <td>Verona</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>10</td>
      <td>0</td>
      <td>Cagliari</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>5</td>
      <td>1</td>
      <td>Fiorentina</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>9</td>
      <td>0</td>
      <td>Inter</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>11</td>
      <td>1</td>
      <td>Juventus</td>
    </tr>
  </tbody>
</table>
</div>




```python
marks_final['rankOpponentTeam'] = map(lambda oppTeam, day: rankOwnTeam(oppTeam, day), marks_final['opponentTeam'], marks_final['day'])
```


```python
marks_final.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player</th>
      <th>name</th>
      <th>team</th>
      <th>day</th>
      <th>goal</th>
      <th>penalty</th>
      <th>owngoal</th>
      <th>mark</th>
      <th>rankOwnTeam</th>
      <th>playingHome</th>
      <th>opponentTeam</th>
      <th>rankOpponentTeam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>10</td>
      <td>1</td>
      <td>Verona</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>10</td>
      <td>0</td>
      <td>Cagliari</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>5</td>
      <td>1</td>
      <td>Fiorentina</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>9</td>
      <td>0</td>
      <td>Inter</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>11</td>
      <td>1</td>
      <td>Juventus</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



let's add some statistics (probably we will remove them because they will be strongly correlated)


```python
def avgPrevious5 (playerName, day):
    marksPlayer = marks_final.ix[(marks_final['name'] == playerName) & (marks_final['day'] >= (day-5)) & (marks_final['day'] < day), 'mark']
    return marksPlayer.mean()

def avgSoFar (playerName, day):
    marksPlayer = marks_final.ix[(marks_final['name'] == playerName) & (marks_final['day'] < day), 'mark']
    return marksPlayer.mean()

def lastMark (playerName, day):
    marksPlayer = marks_final.ix[(marks_final['name'] == playerName) & (marks_final['day'] == day-1), 'mark']
    return marksPlayer.mean()
```


```python
marks_final['avgPrevious5'] = map(lambda playerName, day: avgPrevious5 (playerName, day), marks_final['name'], marks_final['day'])
marks_final['avgSoFar'] = map(lambda playerName, day: avgSoFar (playerName, day), marks_final['name'], marks_final['day'])
marks_final['LastMark'] = map(lambda playerName, day: lastMark (playerName, day), marks_final['name'], marks_final['day'])
```

For the moment, let's aim low, trying to predict if the player's mark will be over 6 (sufficient in italian culture)


```python
def isSuff (mark):
    if mark>=6: return 1
    else: return 0
    
marks_final['isSuff'] = map(lambda mark: isSuff (mark), marks_final['mark'])
```


```python
marks_final.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player</th>
      <th>name</th>
      <th>team</th>
      <th>day</th>
      <th>goal</th>
      <th>penalty</th>
      <th>owngoal</th>
      <th>mark</th>
      <th>rankOwnTeam</th>
      <th>playingHome</th>
      <th>opponentTeam</th>
      <th>rankOpponentTeam</th>
      <th>avgPrevious5</th>
      <th>avgSoFar</th>
      <th>LastMark</th>
      <th>isSuff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>10</td>
      <td>1</td>
      <td>Verona</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.5</td>
      <td>10</td>
      <td>0</td>
      <td>Cagliari</td>
      <td>10</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>7.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.0</td>
      <td>5</td>
      <td>1</td>
      <td>Fiorentina</td>
      <td>15</td>
      <td>7.250000</td>
      <td>7.250000</td>
      <td>7.5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.5</td>
      <td>9</td>
      <td>0</td>
      <td>Inter</td>
      <td>6</td>
      <td>6.833333</td>
      <td>6.833333</td>
      <td>6.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2247</td>
      <td>Sportiello</td>
      <td>Atalanta</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5.0</td>
      <td>11</td>
      <td>1</td>
      <td>Juventus</td>
      <td>1</td>
      <td>6.750000</td>
      <td>6.750000</td>
      <td>6.5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



Uhh, we don't have any mean for the first day of the championship. For the moment, let us feed that value with the average of the championship. 
Alternatively, we could add a "political correct" 6.


```python
To be continued!
```
